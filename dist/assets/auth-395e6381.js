import{B as o}from"./index-daccb512.js";import{m as a}from"./mainRepositories-3199904c.js";import{m as s}from"./mainLocalStorage-8f3300f3.js";const e={user:[],loading:!0,error:null,formData:new FormData},g=o("auth",{state:()=>e,actions:{setFormData(t){Object.entries(t).forEach(([r,i])=>{this.formData.append(r,i)})},async login(t){e.loading=!0,e.error=null;try{this.profil(t),this.period(t);let r=await a.login(t);return r.data.is_correct?(this.user=r.data,this.loading=!1,s.setSessionLogin(t,r.data)):(this.loading=!1,this.error=r.data.message),JSON.stringify(e)}catch(r){return this.loading=!1,this.error=r.message,JSON.stringify(e)}},async profil(t){try{let r=await a.profil(t);return r.data.is_correct?(this.loading=!1,this.user=r.data,s.setProfil(r.data)):(this.loading=!1,this.error=r.data.message),JSON.stringify(e)}catch(r){return this.loading=!1,this.error=r.message,JSON.stringify(e)}},async period(t){try{let r=await a.period(t);return r.data.is_correct?(this.loading=!1,s.setPeriod(r.data.tahunajaran)):(this.loading=!1,this.error=r.data.message),JSON.stringify(e)}catch(r){return this.loading=!1,this.error=r.message,JSON.stringify(e)}},logout(){s.logOut()}}});export{g as a};
