import{b as w}from"./bayar-7ddd21d6.js";import{M as y}from"./mainLocalStorage-1cdc50c7.js";import{A as B}from"./arrayPeriod-595fbeb3.js";import{R as A}from"./rupiah-c3f0a7c7.js";import{F as j}from"./dateFormat-14868802.js";import{B as $,a as L}from"./ButtonFilterYear-829235c6.js";import{q as F}from"./style-7dcc3b35.js";import{a as I,F as N,W as V,G as O}from"./flowbite-vue-9c7e4af1.js";import{_ as C}from"./_plugin-vue_export-helper-c27b6911.js";import{r as _,o as r,c as h,a as e,b as u,t as c,F as f,q as x,s as k,u as g,A as Y,y as P,x as S}from"./index-c4694308.js";import"./mainRepositories-374c5722.js";const J=w(),M={name:"BulananContainer",components:{ButtonFilter:$,Accordion:I,AccordionPanel:N,AccordionHeader:V,AccordionContent:O,ButtonFilterYear:L,VueBottomSheet:F},data(){return{listBulanan:[],firstList:[],listPeriod:B.getList(),sendData:null,isloading:!0,selectedPeriod:[],title:"Pilih Tahun",selesai:!1,pending:!1,total:0}},methods:{async getListBulanan(s){let a=await J.listBulanan(s);var l=JSON.parse(a);console.log("state");const i=l.data.detail;this.listBulanan=i.map(t=>({nama_bayar:t.detail_bulan.nama_bayar,period_start:t.detail_bulan.period_start,period_end:t.detail_bulan.period_end,items:[{month_name:t.detail_bulan.month_name_jul,bill:t.detail_bulan.bill_jul,status:t.detail_bulan.status_jul},{month_name:t.detail_bulan.month_name_agu,bill:t.detail_bulan.bill_agu,status:t.detail_bulan.status_agu},{month_name:t.detail_bulan.month_name_sep,bill:t.detail_bulan.bill_sep,status:t.detail_bulan.status_sep},{month_name:t.detail_bulan.month_name_okt,bill:t.detail_bulan.bill_okt,status:t.detail_bulan.status_okt},{month_name:t.detail_bulan.month_name_nov,bill:t.detail_bulan.bill_nov,status:t.detail_bulan.status_nov},{month_name:t.detail_bulan.month_name_des,bill:t.detail_bulan.bill_des,status:t.detail_bulan.status_des},{month_name:t.detail_bulan.month_name_jan,bill:t.detail_bulan.bill_jan,status:t.detail_bulan.status_jan},{month_name:t.detail_bulan.month_name_feb,bill:t.detail_bulan.bill_feb,status:t.detail_bulan.status_feb},{month_name:t.detail_bulan.month_name_mar,bill:t.detail_bulan.bill_mar,status:t.detail_bulan.status_mar},{month_name:t.detail_bulan.month_name_apr,bill:t.detail_bulan.bill_apr,status:t.detail_bulan.status_apr},{month_name:t.detail_bulan.month_name_mei,bill:t.detail_bulan.bill_mei,status:t.detail_bulan.status_mei},{month_name:t.detail_bulan.month_name_jun,bill:t.detail_bulan.bill_jun,status:t.detail_bulan.status_jun}]})),this.firstList=this.listBulanan,this.total=this.sum(this.listBulanan)},filter(){let s;this.pending==!1&&this.selesai==!0?(console.log("selesai true"),s=this.filterStatus(this.listBulanan)):this.pending==!0&&this.selesai==!1?(console.log("pending true"),s=this.filterStatus(this.listBulanan)):s=this.firstList,this.total=this.sum(s),this.listBulanan=s},togglePending(){this.pending?(this.pending=!1,this.filter()):(this.pending=!0,this.filter())},toggleSelesai(){this.selesai?(this.selesai=!1,this.filter()):(this.selesai=!0,this.filter())},open(){this.$refs.listPeriod.open()},close(){this.$refs.listPeriod.close()},setSelectedPeriod(s){this.selectedPeriod.length<0?this.selectedPeriod.push(s):this.selectedPeriod.includes(s)?this.selectedPeriod.splice(this.selectedPeriod.indexOf(s),1):this.selectedPeriod.push(s)},loadData(){this.setData(),this.getListBulanan(this.sendData),this.close()},setData(){this.sendData=JSON.stringify({nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,period_id:this.selectedPeriod==null||this.selectedPeriod<1?B.getArray():this.selectedPeriod})},filterStatus(s){var a,l=this.pending==!0?"0":"1";return a=s.map(i=>({nama_bayar:i.nama_bayar,period_start:i.period_start,period_end:i.period_end,items:i.items.filter(t=>t.status===l)})),a},sum(s){var a=0;if(s.length==0)a=0;else for(let l=0;l<s.length;l++){const i=s[l];for(let t=0;t<i.items.length;t++){const n=i.items[t];a+=parseInt(n.bill)}}return a},formatRupiah(s){return A.format(s)},formatDateInd(s){return j.fullYearInd(s)}},mounted(){this.setData(),this.getListBulanan(this.sendData)}},q={class:"flex container flex-nowrap overflow-x-auto scrollbar-hidden pt-2"},G={class:"flex space-x-2"},U={class:"flex flex-col"},W={class:"container"},z={class:"block w-full p-3 bg-white border border-gray-200 rounded-lg shadow mt-4 mb-4"},E={class:"font-mulish font-light text-gray-400 text-lg"},H={class:"font-montserrat font-bold text-2xl ps-1 mt-2"},K={class:"flex flex-row my-4 justify-between"},Q=e("button",{class:"border-2 border-blue-500 font-mulish rounded-full text-primaryColors py-2 ms-2 w-1/2"},"Unduh Tagihan",-1),X={class:"container"},Z={class:"flex flex-row justify-between"},tt={class:"container"},et=e("p",{class:"text-gray-400 mb-3 font-mulish"},"Pilih Tahun Ajaran",-1),st={class:"grid grid-cols-3 gap-3 pt-4"},at={class:"flex flex-row justify-end text-end pt-10"},lt=e("button",{class:"font-mulish text-blue-500"},"Batal",-1);function nt(s,a,l,i,t,n){const p=_("ButtonFilterYear"),b=_("ButtonFilter"),v=_("accordion-header"),o=_("accordion-content"),D=_("accordion-panel"),R=_("Accordion"),T=_("vue-bottom-sheet");return r(),h(f,null,[e("div",q,[e("div",G,[u(p,{title:t.title,value:t.selectedPeriod.length>0,onClick:n.open},null,8,["title","value","onClick"]),u(b,{title:"Selesai",value:t.selesai,onClick:n.toggleSelesai},null,8,["value","onClick"]),u(b,{title:"Menunggu Pembayaran",value:t.pending,onClick:n.togglePending},null,8,["value","onClick"])])]),e("div",U,[e("div",W,[e("div",z,[e("p",E,"Tagihan Per "+c(n.formatDateInd(Date())),1),e("p",H,c(n.formatRupiah(t.total)),1),e("div",K,[e("button",{class:"bg-primaryColors font-mulish rounded-full text-white py-2 w-1/2",onClick:a[0]||(a[0]=d=>s.$router.push({name:"bayarBulanan"}))},"Bayar Tagihan"),Q])])]),e("div",X,[(r(!0),h(f,null,x(t.listBulanan,d=>(r(),k(R,{"always-open":"",key:d},{default:g(()=>[u(D,null,{default:g(()=>[u(v,null,{default:g(()=>[Y(c(d.nama_bayar),1)]),_:2},1024),(r(!0),h(f,null,x(d.items,m=>(r(),k(o,{key:m},{default:g(()=>[e("div",Z,[e("div",null,[e("p",null,c(m.month_name+" "+d.period_start+" ("+d.period_start+"/"+d.period_end+")"),1),e("p",null,c(n.formatRupiah(m.bill)),1)]),e("p",{class:P(["mt-2",m.status=="1"?"text-primaryColors":"text-red-500"])},c(m.status=="1"?"Lunas":"Belum Lunas"),3)])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))])]),u(T,{ref:"listPeriod"},{default:g(()=>[e("div",tt,[et,e("div",st,[(r(!0),h(f,null,x(t.listPeriod,d=>(r(),h("div",{key:d},[u(b,{title:d.label,value:t.selectedPeriod!=null?t.selectedPeriod.includes(d.id):"",onClick:m=>n.setSelectedPeriod(d.id)},null,8,["title","value","onClick"])]))),128))]),e("div",at,[lt,e("button",{class:"ms-12 font-mulish text-blue-500",onClick:a[1]||(a[1]=(...d)=>n.loadData&&n.loadData(...d))},"Terapkan")])])]),_:1},512)],64)}const ot=C(M,[["render",nt]]),it=w(),rt={name:"BulananContainer",components:{ButtonFilter:$,ButtonFilterYear:L,VueBottomSheet:F},data(){return{listBebas:[],listPeriod:B.getList(),sendData:null,isloading:!0,selectedPeriod:[],title:"Pilih Tahun",selesai:!1,pending:!1,total:0}},methods:{setData(){this.sendData=JSON.stringify({nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,period_id:this.selectedPeriod==null||this.selectedPeriod<1?B.getArray():this.selectedPeriod})},async getData(){this.isloading=!0;let s=await it.listBebas(this.sendData);var a=JSON.parse(s);a.error==null?(this.listBebas=a.data.bayar.map(l=>({nama_bayar:l.detail_bebas.nama_bayar,period_start:l.detail_bebas.period_start,period_end:l.detail_bebas.period_end,bebas_bill:l.detail_bebas.bebas_bill,bebas_total_pay:l.detail_bebas.bebas_total_pay,status:!(parseInt(l.detail_bebas.bebas_bill)>parseInt(l.detail_bebas.bebas_total_pay))})),this.total=this.listBebas.map(l=>parseInt(l.bebas_bill)-parseInt(l.bebas_total_pay)).reduce((l,i)=>l+i),this.isloading=!1):this.$snackbar.add({type:"error",message:a.error})},open(){this.$refs.listPeriod.open()},close(){this.$refs.listPeriod.close()},setSelectedPeriod(s){this.selectedPeriod.length<0?this.selectedPeriod.push(s):this.selectedPeriod.includes(s)?this.selectedPeriod.splice(this.selectedPeriod.indexOf(s),1):this.selectedPeriod.push(s)},formatRupiah(s){return A.format(s)},formatDateInd(s){return j.fullYearInd(s)}},mounted(){this.setData(),this.getData(this.sendData)}},dt={class:"flex container flex-nowrap overflow-x-auto scrollbar-hidden pt-2"},ut={class:"flex space-x-2"},_t={class:"flex flex-col"},ct={class:"container"},ht={class:"block w-full p-3 bg-white border border-gray-200 rounded-lg shadow mt-4 mb-4"},bt=e("p",{class:"font-mulish font-light text-gray-400 text-lg"},"Tagihan Bebas",-1),ft={class:"font-montserrat font-bold text-2xl ps-1 mt-2"},pt={class:"flex flex-row my-4 justify-between"},mt=e("button",{class:"border-2 border-green-500 rounded-full text-primaryColors py-2 ms-2 w-1/2"},"Unduh Tagihan",-1),gt={class:"border-t-2 border-gray-100"},yt={class:"flex flex-row justify-between py-2 px-4"},vt={class:"flex-col flex"},xt={class:"font-montserrat font-bold text-base"},Bt={class:"font-montserrat text-sm"},kt={class:"flex justify-center items-center"},Pt={class:"container"},wt=e("p",{class:"text-gray-400 mb-3 font-mulish"},"Pilih Tahun Ajaran",-1),Ct={class:"grid grid-cols-3 gap-3 pt-4"},Dt={class:"flex flex-row justify-end text-end pt-10"},St=e("button",{class:"font-mulish text-blue-500"},"Batal",-1);function At(s,a,l,i,t,n){const p=_("ButtonFilterYear"),b=_("ButtonFilter"),v=_("vue-bottom-sheet");return r(),h(f,null,[e("div",dt,[e("div",ut,[u(p,{title:t.title,value:t.selectedPeriod.length>0,onClick:n.open},null,8,["title","value","onClick"]),u(b,{title:"Selesai",value:t.selesai,onClick:s.toggleSelesai},null,8,["value","onClick"]),u(b,{title:"Menunggu Pembayaran",value:t.pending,onClick:s.togglePending},null,8,["value","onClick"])])]),e("div",_t,[e("div",ct,[e("div",ht,[bt,e("p",ft,c(n.formatRupiah(t.total)),1),e("div",pt,[e("button",{class:"bg-primaryColors rounded-full text-white py-2 w-1/2",onClick:a[0]||(a[0]=o=>s.$router.push({name:"bayarBebas"}))},"Bayar Tagihan"),mt])])]),(r(!0),h(f,null,x(t.listBebas,o=>(r(),h("div",{class:"flex flex-col mt-3",key:o},[e("div",gt,[e("div",yt,[e("div",vt,[e("p",xt,c(o.nama_bayar),1),e("p",Bt,c(n.formatRupiah(o.bebas_bill))+" dibayar "+c(n.formatRupiah(o.bebas_total_pay)),1)]),e("div",kt,[e("p",{class:P(["font-montserrat text-center align-middle text-sm",o.status==!0?"text-green-500":"text-red-500"])},c(o.status==!0?"Lunas":"Belum Lunas"),3)])])])]))),128))]),u(v,{ref:"listPeriod"},{default:g(()=>[e("div",Pt,[wt,e("div",Ct,[(r(!0),h(f,null,x(t.listPeriod,o=>(r(),h("div",{key:o},[u(b,{title:o.label,value:t.selectedPeriod!=null?t.selectedPeriod.includes(o.id):"",onClick:D=>n.setSelectedPeriod(o.id)},null,8,["title","value","onClick"])]))),128))]),e("div",Dt,[St,e("button",{class:"ms-12 font-mulish text-blue-500",onClick:a[1]||(a[1]=(...o)=>s.loadData&&s.loadData(...o))},"Terapkan")])])]),_:1},512)],64)}const jt=C(rt,[["render",At]]);const $t=w(),Lt={name:"BayarView",components:{BulananContainer:ot,BebasContainer:jt},data(){return{user:[],ImageProfile:null,active_tab:"bulanan",slides:[],itemLength:0}},mounted(){this.getRingkasan()},methods:{setData(){this.sendData=JSON.stringify({student_nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,bayar:"Bayar",bulan_id:[],bebas_id:[]})},async getRingkasan(){this.isLoading=!0,this.setData();let s=await $t.listRingkasan(this.sendData),a=JSON.parse(s);if(console.log(a),a.success){this.dataRingkasan=a.data;const{bebas:l,bulan:i,...t}=a.data;this.dataRingkasan=t,this.listBebas=l,this.listBulan=i,this.itemLength=l.length+i.length,this.isLoading=!1}else this.$snackbar.add({type:"error",text:a.error})},getBulanan(){this.active_tab="bulanan"},getBebas(){this.active_tab="bebas"}}},Ft={class:"flex flex-col h-100"},Rt={class:"bg-primaryColors top-0 sticky w-full"},Tt={class:"container flex flex-row items-center justify-between"},It=e("p",{class:"text-center text-white font-[500px] font-mulish py-4"},"Bayar",-1),Nt={class:"absolute right-0 top-0 rounded-full bg-red-600 w-4 h-4 top right text-white font-mono text-sm leading-tight text-center"},Vt={class:"flex flex-row w-full"},Ot=e("p",{class:"text-center font-mulish"},"Bulanan",-1),Yt=[Ot],Jt=e("p",{class:"text-center font-mulish"},"Bebas",-1),Mt=[Jt],qt={class:"flex-grow pt-4"};function Gt(s,a,l,i,t,n){const p=_("font-awesome-icon"),b=_("BulananContainer"),v=_("BebasContainer");return r(),h("div",Ft,[e("header",Rt,[e("div",Tt,[u(p,{class:"text-white",icon:"arrow-left",onClick:a[0]||(a[0]=o=>this.$router.push({name:"home"}))}),It,e("div",{class:"relative flex h-10 w-10 items-center",onClick:a[1]||(a[1]=o=>s.$router.push({name:"ringkasanPembayaran"}))},[u(p,{icon:["fas","cart-shopping"],class:"text-white flex-1"}),e("span",Nt,c(t.itemLength),1)])]),e("div",Vt,[e("button",{onClick:a[2]||(a[2]=(...o)=>n.getBulanan&&n.getBulanan(...o)),class:P(["w-full  p-4 rounded-t-lg ",t.active_tab=="bulanan"?"isActive":"isNotActive"])},Yt,2),e("button",{onClick:a[3]||(a[3]=(...o)=>n.getBebas&&n.getBebas(...o)),class:P(["w-full  p-4 rounded-t-lg ",t.active_tab=="bebas"?"isActive":"isNotActive"])},Mt,2)])]),e("main",qt,[t.active_tab=="bulanan"?(r(),k(b,{key:0})):S("",!0),t.active_tab=="bebas"?(r(),k(v,{key:1})):S("",!0)])])}const se=C(Lt,[["render",Gt]]);export{se as default};
