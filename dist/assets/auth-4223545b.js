import{z as o}from"./index-a9283fbe.js";import{m as a}from"./mainRepositories-46430b54.js";import{m as e}from"./mainLocalStorage-8f3300f3.js";const s={user:[],loading:!0,error:null,formData:new FormData},f=o("auth",{state:()=>s,actions:{setFormData(r){Object.entries(r).forEach(([t,i])=>{this.formData.append(t,i)})},async login(r){this.setFormData(r);try{this.profil(r),this.period(r);let t=await a.login(r);return t.data.is_correct?(this.user=t.data,this.loading=!1,e.setSessionLogin(r,t.data)):(this.loading=!1,this.error=t.data.message),JSON.stringify(s)}catch(t){return this.loading=!1,this.error=t.message,JSON.stringify(s)}},async profil(r){try{let t=await a.profil(r);return t.data.is_correct?(this.loading=!1,console.log(t.data),this.user=t.data,e.setProfil(t.data)):(this.loading=!1,this.error=t.data.message),JSON.stringify(s)}catch(t){return this.loading=!1,this.error=t.message,JSON.stringify(s)}},async period(r){try{let t=await a.period(r);return console.log("period",t.data),t.data.is_correct?(this.loading=!1,e.setPeriod(t.data.tahunajaran)):(this.loading=!1,this.error=t.data.message),JSON.stringify(s)}catch(t){return this.loading=!1,this.error=t.message,JSON.stringify(s)}},logout(){e.logOut()}}});export{f as a};
