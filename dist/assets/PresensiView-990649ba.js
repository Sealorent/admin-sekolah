import{z as w,r as a,o as i,c as l,s as C,x as B,a as t,b as c,F as h,q as m,t as f,u as S,y as F}from"./index-29abdbc7.js";import{m as L}from"./mainRepositories-2fcd8aa7.js";import{a as D,B as A,A as b}from"./arrayPeriod-053f4939.js";import{F as N}from"./dateFormat-14868802.js";import{m as y}from"./mainLocalStorage-6a318ee8.js";import{q as j}from"./style-32461936.js";import{L as J}from"./LoadingContainer-1bb784a7.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";import"./flowbite-vue-fc332bb1.js";const u={data:[],loading:!0,error:null},I=w("presensi",{state:()=>u,actions:{async listPresensi(s){try{let e=await L.listPresensi(s);return console.log(e),e.data.is_correct==!0?(this.data=e.data.laporan,this.loading=!1,this.error=null):(this.loading=!1,this.error=e.data.laporan),console.log(u),JSON.stringify(u)}catch(e){return this.loading=!1,this.error=e.message,JSON.stringify(u)}}}});class O{static getListMonth(){return[{month:"Januari",number:7},{month:"Februari",number:8},{month:"Maret",number:9},{month:"April",number:10},{month:"Mei",number:11},{month:"Juni",number:12},{month:"Juli",number:1},{month:"Agustus",number:2},{month:"September",number:3},{month:"Oktober",number:4},{month:"November",number:5},{month:"Desember",number:6}]}static getFirstMonth(){let e=this.getListMonth();var d=new Date;return e.filter(_=>_.number==d.getMonth()+1-6)[0]}static getArrayMonth(){return this.getListMonth().map(d=>d.number)}}const v=O;const T=I(),Y={name:"PresensiView",components:{ButtonFilterYear:D,VueBottomSheet:j,ButtonFilter:A,LoadingCircle:J},data(){return{listPresensi:[],listMonth:v.getListMonth(),listPeriod:b.getList(),selectedPeriod:[],selectedMonth:[],title:"Pilih Tahun",message:null,isLoading:!1}},methods:{setData(){this.sendData=JSON.stringify({nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,period_id:this.selectedPeriod==null||this.selectedPeriod<1?b.getArray():this.selectedPeriod.map(s=>parseInt(s)),bulan:this.selectedMonth==null||this.selectedMonth<1?v.getArrayMonth():this.selectedMonth.map(s=>parseInt(s))})},async getPresensi(){this.isLoading=!0,this.setData();let s=await T.listPresensi(this.sendData);var e=JSON.parse(s);e.error==null?(this.listPresensi=e.data,this.isLoading=e.loading,this.message=e.error):(this.listPresensi=[],this.message=e.message,this.isLoading=e.loading,this.message=e.error),console.log(e)},setSelectedPeriod(s){this.selectedPeriod.includes(s)?this.selectedPeriod=this.selectedPeriod.filter(e=>e!=s):this.selectedPeriod.push(s)},setSelectedMonth(s){this.selectedMonth.includes(s)?this.selectedMonth=this.selectedMonth.filter(e=>e!=s):this.selectedMonth.push(s)},loadData(){this.getPresensi(),this.closeFilter()},openFilter(){this.$refs.myBottomSheet.open()},closeFilter(){this.$refs.myBottomSheet.close()},formatDateInd(s){return N.fullYearInd(s)}},mounted(){this.getPresensi()}},H={class:"flex flex-col h-100"},q={class:"bg-primaryColors top-0 sticky w-full"},z={class:"container flex flex-row items-center justify-between"},E=t("p",{class:"text-center text-white font-[20px] font-mulish py-4"},"Presensi",-1),R=t("p",null,null,-1),G={class:"flex-grow pt-4"},K={class:"container flex flex-col gap-y-5"},Q={class:"flex flex-row justify-between items-center"},U=t("p",{class:"font-mulish"},"Tahun Ajaran",-1),W={class:"flex flex-col"},X=["onClick"],Z={class:"font-mulish"},$={class:"flex items-center justify-center"},ee={class:"flex flex-col pb-10"},te={class:"container"},se=t("p",{class:"text-gray-400 mb-3 font-mulish"},"Pilih Tahun Ajaran",-1),ne={class:"grid grid-cols-3 gap-3 pt-1"},oe={class:"container mt-2"},ie=t("p",{class:"text-gray-400 my-3 font-mulish"},"Pilih Bulan",-1),le={class:"grid grid-cols-4 gap-3 pt-1"},re={class:"flex flex-row justify-end text-end pt-10"};function ae(s,e,d,_,o,r){const P=a("LoadingCircle"),x=a("font-awesome-icon"),k=a("ButtonFilterYear"),g=a("ButtonFilter"),M=a("vue-bottom-sheet");return i(),l(h,null,[o.isLoading?(i(),C(P,{key:0})):B("",!0),t("div",H,[t("header",q,[t("div",z,[c(x,{class:"text-white",icon:"arrow-left",onClick:e[0]||(e[0]=n=>this.$router.push({name:"home"}))}),E,R])]),t("main",G,[t("div",K,[t("div",Q,[U,c(k,{title:o.title,value:o.selectedPeriod.length>0||o.selectedMonth.length>0,onClick:r.openFilter},null,8,["title","value","onClick"])]),t("div",W,[(i(!0),l(h,null,m(o.listPresensi,n=>(i(),l("div",{class:"flex flex-row justify-between border-t-2 w-full py-4",key:n,onClick:p=>s.detail(n)},[t("p",Z,f(r.formatDateInd(n.detail.tanggal)),1),t("p",{class:F(["font-mulish",n.detail.kehadiran=="H"?"text-green-500":"text-red-500"])},f(n.detail.kehadiran=="H"?"Hadir":"Absen"),3)],8,X))),128)),t("div",$,f(o.message),1)])])])]),c(M,{ref:"myBottomSheet"},{default:S(()=>[t("div",ee,[t("div",te,[se,t("div",ne,[(i(!0),l(h,null,m(o.listPeriod,n=>(i(),l("div",{key:n},[c(g,{title:n.label,value:o.selectedPeriod!=null?o.selectedPeriod.includes(n.id):"",onClick:p=>r.setSelectedPeriod(n.id)},null,8,["title","value","onClick"])]))),128))])]),t("div",oe,[ie,t("div",le,[(i(!0),l(h,null,m(o.listMonth,n=>(i(),l("div",{key:n},[c(g,{title:n.month,value:o.selectedMonth!=null?o.selectedMonth.includes(n.number):"",onClick:p=>r.setSelectedMonth(n.number)},null,8,["title","value","onClick"])]))),128))]),t("div",re,[t("button",{class:"font-mulish text-blue-500",onClick:e[1]||(e[1]=(...n)=>s.batal&&s.batal(...n))},"Batal"),t("button",{class:"ms-12 font-mulish text-blue-500",onClick:e[2]||(e[2]=(...n)=>r.loadData&&r.loadData(...n))},"Terapkan")])])])]),_:1},512)],64)}const be=V(Y,[["render",ae]]);export{be as default};
