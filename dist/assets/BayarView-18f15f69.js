import{b as C}from"./bayar-dfd0d0ff.js";import{m as y}from"./mainLocalStorage-8f3300f3.js";import{B as A,a as j,A as B}from"./arrayPeriod-d5354f41.js";import{R as L}from"./rupiah-c3f0a7c7.js";import{F as $}from"./dateFormat-14868802.js";import{q as F}from"./style-05dc6766.js";import{a as I,F as N,W as V,G as O}from"./flowbite-vue-29b55b18.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import{r as _,o as r,c as h,a as e,b as u,t as c,F as f,u as x,x as k,y as g,C as Y,A as P,z as w}from"./index-daccb512.js";import"./mainRepositories-3199904c.js";const J=C(),z={name:"BulananContainer",components:{ButtonFilter:A,Accordion:I,AccordionPanel:N,AccordionHeader:V,AccordionContent:O,ButtonFilterYear:j,VueBottomSheet:F},data(){return{listBulanan:[],firstList:[],listPeriod:B.getList(),sendData:null,isloading:!0,selectedPeriod:[],title:"Pilih Tahun",selesai:!1,pending:!1,total:0}},methods:{async getListBulanan(s){let a=await J.listBulanan(s);var l=JSON.parse(a);console.log("state");const i=l.data.detail;this.listBulanan=i.map(t=>({nama_bayar:t.detail_bulan.nama_bayar,period_start:t.detail_bulan.period_start,period_end:t.detail_bulan.period_end,items:[{month_name:t.detail_bulan.month_name_jul,bill:t.detail_bulan.bill_jul,status:t.detail_bulan.status_jul},{month_name:t.detail_bulan.month_name_agu,bill:t.detail_bulan.bill_agu,status:t.detail_bulan.status_agu},{month_name:t.detail_bulan.month_name_sep,bill:t.detail_bulan.bill_sep,status:t.detail_bulan.status_sep},{month_name:t.detail_bulan.month_name_okt,bill:t.detail_bulan.bill_okt,status:t.detail_bulan.status_okt},{month_name:t.detail_bulan.month_name_nov,bill:t.detail_bulan.bill_nov,status:t.detail_bulan.status_nov},{month_name:t.detail_bulan.month_name_des,bill:t.detail_bulan.bill_des,status:t.detail_bulan.status_des},{month_name:t.detail_bulan.month_name_jan,bill:t.detail_bulan.bill_jan,status:t.detail_bulan.status_jan},{month_name:t.detail_bulan.month_name_feb,bill:t.detail_bulan.bill_feb,status:t.detail_bulan.status_feb},{month_name:t.detail_bulan.month_name_mar,bill:t.detail_bulan.bill_mar,status:t.detail_bulan.status_mar},{month_name:t.detail_bulan.month_name_apr,bill:t.detail_bulan.bill_apr,status:t.detail_bulan.status_apr},{month_name:t.detail_bulan.month_name_mei,bill:t.detail_bulan.bill_mei,status:t.detail_bulan.status_mei},{month_name:t.detail_bulan.month_name_jun,bill:t.detail_bulan.bill_jun,status:t.detail_bulan.status_jun}]})),this.firstList=this.listBulanan,this.total=this.sum(this.listBulanan)},filter(){let s;this.pending==!1&&this.selesai==!0?(console.log("selesai true"),s=this.filterStatus(this.listBulanan)):this.pending==!0&&this.selesai==!1?(console.log("pending true"),s=this.filterStatus(this.listBulanan)):s=this.firstList,this.total=this.sum(s),this.listBulanan=s},togglePending(){this.pending?(this.pending=!1,this.filter()):(this.pending=!0,this.filter())},toggleSelesai(){this.selesai?(this.selesai=!1,this.filter()):(this.selesai=!0,this.filter())},open(){this.$refs.listPeriod.open()},close(){this.$refs.listPeriod.close()},setSelectedPeriod(s){this.selectedPeriod.length<0?this.selectedPeriod.push(s):this.selectedPeriod.includes(s)?this.selectedPeriod.splice(this.selectedPeriod.indexOf(s),1):this.selectedPeriod.push(s)},loadData(){this.setData(),this.getListBulanan(this.sendData),this.close()},setData(){this.sendData=JSON.stringify({nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,period_id:this.selectedPeriod==null||this.selectedPeriod<1?B.getArray():this.selectedPeriod})},filterStatus(s){var a,l=this.pending==!0?"0":"1";return a=s.map(i=>({nama_bayar:i.nama_bayar,period_start:i.period_start,period_end:i.period_end,items:i.items.filter(t=>t.status===l)})),a},sum(s){var a=0;if(s.length==0)a=0;else for(let l=0;l<s.length;l++){const i=s[l];for(let t=0;t<i.items.length;t++){const n=i.items[t];a+=parseInt(n.bill)}}return a},formatRupiah(s){return L.format(s)},formatDateInd(s){return $.fullYearInd(s)}},mounted(){this.setData(),this.getListBulanan(this.sendData)}},G={class:"flex container flex-nowrap overflow-x-auto scrollbar-hidden pt-2"},M={class:"flex space-x-2"},U={class:"flex flex-col"},W={class:"container"},q={class:"block w-full p-3 bg-white border border-gray-200 rounded-lg shadow mt-4 mb-4"},E={class:"font-mulish font-light text-gray-400 text-lg"},H={class:"font-montserrat font-bold text-2xl ps-1 mt-2"},K={class:"flex flex-row my-4 justify-between"},Q={class:"container"},X={class:"flex flex-row justify-between"},Z={class:"container"},tt=e("p",{class:"text-gray-400 mb-3 font-mulish"},"Pilih Tahun Ajaran",-1),et={class:"grid grid-cols-3 gap-3 pt-4"},st={class:"flex flex-row justify-end text-end pt-10"},at=e("button",{class:"font-mulish text-blue-500"},"Batal",-1);function lt(s,a,l,i,t,n){const p=_("ButtonFilterYear"),b=_("ButtonFilter"),v=_("accordion-header"),o=_("accordion-content"),S=_("accordion-panel"),R=_("Accordion"),T=_("vue-bottom-sheet");return r(),h(f,null,[e("div",G,[e("div",M,[u(p,{title:t.title,value:t.selectedPeriod.length>0,onClick:n.open},null,8,["title","value","onClick"]),u(b,{title:"Selesai",value:t.selesai,onClick:n.toggleSelesai},null,8,["value","onClick"]),u(b,{title:"Menunggu Pembayaran",value:t.pending,onClick:n.togglePending},null,8,["value","onClick"])])]),e("div",U,[e("div",W,[e("div",q,[e("p",E,"Tagihan Per "+c(n.formatDateInd(Date())),1),e("p",H,c(n.formatRupiah(t.total)),1),e("div",K,[e("button",{class:"bg-primaryColors font-mulish rounded-full text-white py-2 w-1/2",onClick:a[0]||(a[0]=d=>s.$router.push({name:"bayarBulanan"}))},"Bayar Tagihan"),e("button",{class:"border-2 border-blue-500 font-mulish rounded-full text-primaryColors py-2 ms-2 w-1/2",onClick:a[1]||(a[1]=d=>s.$router.push({name:"getPdf",params:{type:"bulanan"}}))},"Unduh Tagihan")])])]),e("div",Q,[(r(!0),h(f,null,x(t.listBulanan,d=>(r(),k(R,{"always-open":"",key:d},{default:g(()=>[u(S,null,{default:g(()=>[u(v,null,{default:g(()=>[Y(c(d.nama_bayar),1)]),_:2},1024),(r(!0),h(f,null,x(d.items,m=>(r(),k(o,{key:m},{default:g(()=>[e("div",X,[e("div",null,[e("p",null,c(m.month_name+" "+d.period_start+" ("+d.period_start+"/"+d.period_end+")"),1),e("p",null,c(n.formatRupiah(m.bill)),1)]),e("p",{class:P(["mt-2",m.status=="1"?"text-primaryColors":"text-red-500"])},c(m.status=="1"?"Lunas":"Belum Lunas"),3)])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))])]),u(T,{ref:"listPeriod"},{default:g(()=>[e("div",Z,[tt,e("div",et,[(r(!0),h(f,null,x(t.listPeriod,d=>(r(),h("div",{key:d},[u(b,{title:d.label,value:t.selectedPeriod!=null?t.selectedPeriod.includes(d.id):"",onClick:m=>n.setSelectedPeriod(d.id)},null,8,["title","value","onClick"])]))),128))]),e("div",st,[at,e("button",{class:"ms-12 font-mulish text-blue-500",onClick:a[2]||(a[2]=(...d)=>n.loadData&&n.loadData(...d))},"Terapkan")])])]),_:1},512)],64)}const nt=D(z,[["render",lt]]),ot=C(),it={name:"BulananContainer",components:{ButtonFilter:A,ButtonFilterYear:j,VueBottomSheet:F},data(){return{listBebas:[],listPeriod:B.getList(),sendData:null,isloading:!0,selectedPeriod:[],title:"Pilih Tahun",selesai:!1,pending:!1,total:0}},methods:{setData(){this.sendData=JSON.stringify({nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,period_id:this.selectedPeriod==null||this.selectedPeriod<1?B.getArray():this.selectedPeriod})},async getData(){this.isloading=!0;let s=await ot.listBebas(this.sendData);var a=JSON.parse(s);a.error==null?(this.listBebas=a.data.bayar.map(l=>({nama_bayar:l.detail_bebas.nama_bayar,period_start:l.detail_bebas.period_start,period_end:l.detail_bebas.period_end,bebas_bill:l.detail_bebas.bebas_bill,bebas_total_pay:l.detail_bebas.bebas_total_pay,status:!(parseInt(l.detail_bebas.bebas_bill)>parseInt(l.detail_bebas.bebas_total_pay))})),this.total=this.listBebas.map(l=>parseInt(l.bebas_bill)-parseInt(l.bebas_total_pay)).reduce((l,i)=>l+i),this.isloading=!1):this.$snackbar.add({type:"error",message:a.error})},open(){this.$refs.listPeriod.open()},close(){this.$refs.listPeriod.close()},setSelectedPeriod(s){this.selectedPeriod.length<0?this.selectedPeriod.push(s):this.selectedPeriod.includes(s)?this.selectedPeriod.splice(this.selectedPeriod.indexOf(s),1):this.selectedPeriod.push(s)},formatRupiah(s){return L.format(s)},formatDateInd(s){return $.fullYearInd(s)}},mounted(){this.setData(),this.getData(this.sendData)}},rt={class:"flex container flex-nowrap overflow-x-auto scrollbar-hidden pt-2"},dt={class:"flex space-x-2"},ut={class:"flex flex-col"},_t={class:"container"},ct={class:"block w-full p-3 bg-white border border-gray-200 rounded-lg shadow mt-4 mb-4"},ht=e("p",{class:"font-mulish font-light text-gray-400 text-lg"},"Tagihan Bebas",-1),bt={class:"font-montserrat font-bold text-2xl ps-1 mt-2"},ft={class:"flex flex-row my-4 justify-between"},pt=e("button",{class:"border-2 border-green-500 rounded-full text-primaryColors py-2 ms-2 w-1/2"},"Unduh Tagihan",-1),mt={class:"border-t-2 border-gray-100"},gt={class:"flex flex-row justify-between py-2 px-4"},yt={class:"flex-col flex"},vt={class:"font-montserrat font-bold text-base"},xt={class:"font-montserrat text-sm"},Bt={class:"flex justify-center items-center"},kt={class:"container"},Pt=e("p",{class:"text-gray-400 mb-3 font-mulish"},"Pilih Tahun Ajaran",-1),wt={class:"grid grid-cols-3 gap-3 pt-4"},Ct={class:"flex flex-row justify-end text-end pt-10"},Dt=e("button",{class:"font-mulish text-blue-500"},"Batal",-1);function St(s,a,l,i,t,n){const p=_("ButtonFilterYear"),b=_("ButtonFilter"),v=_("vue-bottom-sheet");return r(),h(f,null,[e("div",rt,[e("div",dt,[u(p,{title:t.title,value:t.selectedPeriod.length>0,onClick:n.open},null,8,["title","value","onClick"]),u(b,{title:"Selesai",value:t.selesai,onClick:s.toggleSelesai},null,8,["value","onClick"]),u(b,{title:"Menunggu Pembayaran",value:t.pending,onClick:s.togglePending},null,8,["value","onClick"])])]),e("div",ut,[e("div",_t,[e("div",ct,[ht,e("p",bt,c(n.formatRupiah(t.total)),1),e("div",ft,[e("button",{class:"bg-primaryColors rounded-full text-white py-2 w-1/2",onClick:a[0]||(a[0]=o=>s.$router.push({name:"bayarBebas"}))},"Bayar Tagihan"),pt])])]),(r(!0),h(f,null,x(t.listBebas,o=>(r(),h("div",{class:"flex flex-col mt-3",key:o},[e("div",mt,[e("div",gt,[e("div",yt,[e("p",vt,c(o.nama_bayar),1),e("p",xt,c(n.formatRupiah(o.bebas_bill))+" dibayar "+c(n.formatRupiah(o.bebas_total_pay)),1)]),e("div",Bt,[e("p",{class:P(["font-montserrat text-center align-middle text-sm",o.status==!0?"text-green-500":"text-red-500"])},c(o.status==!0?"Lunas":"Belum Lunas"),3)])])])]))),128))]),u(v,{ref:"listPeriod"},{default:g(()=>[e("div",kt,[Pt,e("div",wt,[(r(!0),h(f,null,x(t.listPeriod,o=>(r(),h("div",{key:o},[u(b,{title:o.label,value:t.selectedPeriod!=null?t.selectedPeriod.includes(o.id):"",onClick:S=>n.setSelectedPeriod(o.id)},null,8,["title","value","onClick"])]))),128))]),e("div",Ct,[Dt,e("button",{class:"ms-12 font-mulish text-blue-500",onClick:a[1]||(a[1]=(...o)=>s.loadData&&s.loadData(...o))},"Terapkan")])])]),_:1},512)],64)}const At=D(it,[["render",St]]);const jt=C(),Lt={name:"BayarView",components:{BulananContainer:nt,BebasContainer:At},data(){return{user:[],ImageProfile:null,active_tab:"bulanan",slides:[],itemLength:0}},mounted(){this.getRingkasan()},methods:{setData(){this.sendData=JSON.stringify({student_nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,bayar:"Bayar",bulan_id:[],bebas_id:[]})},async getRingkasan(){this.isLoading=!0,this.setData();let s=await jt.listRingkasan(this.sendData),a=JSON.parse(s);if(console.log(a),a.success){this.dataRingkasan=a.data;const{bebas:l,bulan:i,...t}=a.data;this.dataRingkasan=t,this.listBebas=l,this.listBulan=i,this.itemLength=l.length+i.length,this.isLoading=!1}else this.$snackbar.add({type:"error",text:a.error})},getBulanan(){this.active_tab="bulanan"},getBebas(){this.active_tab="bebas"}}},$t={class:"flex flex-col h-100"},Ft={class:"bg-primaryColors top-0 sticky w-full"},Rt={class:"container flex flex-row items-center justify-between"},Tt=e("p",{class:"text-center text-white font-[500px] font-mulish py-4"},"Bayar",-1),It={key:0,class:"absolute right-0 top-0 rounded-full bg-red-600 w-4 h-4 top right text-white font-mono text-sm leading-tight text-center"},Nt={class:"flex flex-row w-full"},Vt=e("p",{class:"text-center font-mulish"},"Bulanan",-1),Ot=[Vt],Yt=e("p",{class:"text-center font-mulish"},"Bebas",-1),Jt=[Yt],zt={class:"flex-grow pt-4"};function Gt(s,a,l,i,t,n){const p=_("font-awesome-icon"),b=_("BulananContainer"),v=_("BebasContainer");return r(),h("div",$t,[e("header",Ft,[e("div",Rt,[u(p,{class:"text-white",icon:"arrow-left",onClick:a[0]||(a[0]=o=>this.$router.push({name:"home"}))}),Tt,e("div",{class:"relative flex h-10 w-10 items-center",onClick:a[1]||(a[1]=o=>s.$router.push({name:"ringkasanPembayaran"}))},[u(p,{icon:["fas","cart-shopping"],class:"text-white flex-1"}),t.itemLength>0?(r(),h("span",It,c(t.itemLength),1)):w("",!0)])]),e("div",Nt,[e("button",{onClick:a[2]||(a[2]=(...o)=>n.getBulanan&&n.getBulanan(...o)),class:P(["w-full  p-4 rounded-t-lg ",t.active_tab=="bulanan"?"isActive":"isNotActive"])},Ot,2),e("button",{onClick:a[3]||(a[3]=(...o)=>n.getBebas&&n.getBebas(...o)),class:P(["w-full  p-4 rounded-t-lg ",t.active_tab=="bebas"?"isActive":"isNotActive"])},Jt,2)])]),e("main",zt,[t.active_tab=="bulanan"?(r(),k(b,{key:0})):w("",!0),t.active_tab=="bebas"?(r(),k(v,{key:1})):w("",!0)])])}const te=D(Lt,[["render",Gt]]);export{te as default};
