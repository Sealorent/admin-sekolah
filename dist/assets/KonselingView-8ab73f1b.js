import{z as B,r as c,o as a,c as r,s as K,x as p,a as e,b as d,t as l,F as u,q as g,u as x}from"./index-c4694308.js";import{m as C}from"./mainRepositories-374c5722.js";import{M as y}from"./mainLocalStorage-1cdc50c7.js";import{A as v}from"./arrayPeriod-595fbeb3.js";import{B as S,a as F}from"./ButtonFilterYear-829235c6.js";import{q as L}from"./style-7dcc3b35.js";import{L as j}from"./LoadingContainer-c572b9e8.js";import{F as A}from"./dateFormat-14868802.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import"./flowbite-vue-9c7e4af1.js";const _={data:[],loading:!0,error:null},V=B("konseling",{state:()=>_,actions:{async listKonseling(i){try{let t=await C.listKonseling(i);return console.log(t),t.data.is_correct==!0?(this.data=t.data.laporan,this.loading=!1,this.error=null):(this.loading=!1,this.error=t.data.laporan),console.log(_),JSON.stringify(_)}catch(t){return this.loading=!1,this.error=t.message,JSON.stringify(_)}}}});const I=V(),T={name:"KonselingView",components:{LoadingCircle:j,ButtonFilter:S,ButtonFilterYear:F,VueBottomSheet:L},data(){return{listKonseling:[],listPeriod:v.getList(),selectedPeriod:[],title:"Pilih Tahun",message:null,jumlahPoin:0,isLoading:!1,arrDetail:null}},methods:{setData(){this.sendData=JSON.stringify({nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,period_id:this.selectedPeriod==null||this.selectedPeriod<1?v.getArray():this.selectedPeriod.map(i=>parseInt(i))})},async getKonseling(){this.isLoading=!0,this.setData();let i=await I.listKonseling(this.sendData);var t=JSON.parse(i);console.log(t),t.error==null?(this.isLoading=t.loading,this.listKonseling=t.data,this.jumlahPoin=t.data.map(h=>h.detail.poin).reduce((h,m)=>h+m),this.message=t.error):(this.listKonseling=[],this.jumlahPoin=0,this.isLoading=t.loading,this.message=t.error)},loadData(){this.getKonseling(),this.closeFilter()},setSelectedPeriod(i){this.selectedPeriod.includes(i)?this.selectedPeriod=this.selectedPeriod.filter(t=>t!=i):this.selectedPeriod.push(i)},detail(i){this.arrDetail=i,this.openDetail()},batal(){this.selectedPeriod=[],this.$refs.myBottomSheet.close()},openFilter(){this.$refs.myBottomSheet.open()},closeFilter(){this.$refs.myBottomSheet.close()},openDetail(){this.$refs.detailKonseling.open()},closeDetail(){this.$refs.detailKonseling.close()},formatDateInd(i){return A.fullYearInd(i)}},mounted(){this.getKonseling()}},J={class:"flex flex-col h-100"},O={class:"bg-primaryColors top-0 sticky w-full"},Y={class:"container flex flex-row items-center justify-between"},M=e("p",{class:"text-center text-white font-[20px] font-mulish py-4"},"Konseling",-1),q=e("p",null,null,-1),z={class:"flex-grow pt-4"},E={class:"container flex flex-col gap-y-5"},H={class:"flex flex-row justify-between items-center"},R=e("p",{class:"font-mulish"},"Tahun Ajaran",-1),G={class:"border-2 shadow-sm px-4 py-2"},Q=e("p",{class:"font-mulish text-[14px]"},"Jumlah Hafalan",-1),U={class:"font-mulish text-[32px]"},W={class:"flex flex-col"},X=["onClick"],Z={class:"flex flex-col py-2"},$={class:"font-mulish font-semibold"},ee={class:"font-mulish text-sm text-gray-400"},te={class:"flex items-center"},se={class:"font-mulish text-red-500"},oe={class:"flex items-center justify-center"},ie={class:"container"},le=e("p",{class:"text-gray-400 mb-3 font-mulish"},"Pilih Tahun Ajaran",-1),ne={class:"grid grid-cols-3 gap-3 pt-4"},ae={class:"flex flex-row justify-end text-end pt-10"},re={key:0,class:"container"},ce={class:"flex flex-col"},de={class:"mb-3"},he=e("p",{class:"font-mulish uppercase text-gray-500"},"Pelanggaran",-1),_e={class:"font-mulish capitalize"},ue={class:"mb-3"},me=e("p",{class:"font-mulish uppercase text-gray-500"},"Poin Pelanggaran",-1),fe={class:"font-mulish text-red-500"},pe={class:"mb-3"},ge=e("p",{class:"font-mulish uppercase text-gray-500"},"Tanggal",-1),xe={class:"font-mulish"},ye={class:"mb-3"},ve=e("p",{class:"font-mulish uppercase text-gray-500"},"Tindakan",-1),ke={class:"font-mulish"},Pe={class:"mb-3"},be=e("p",{class:"font-mulish uppercase text-gray-500"},"Murotal",-1),De={class:"font-mulish"};function we(i,t,h,m,s,n){const k=c("LoadingCircle"),P=c("font-awesome-icon"),b=c("ButtonFilterYear"),D=c("ButtonFilter"),f=c("vue-bottom-sheet");return a(),r(u,null,[s.isLoading?(a(),K(k,{key:0})):p("",!0),e("div",J,[e("header",O,[e("div",Y,[d(P,{class:"text-white",icon:"arrow-left",onClick:t[0]||(t[0]=o=>this.$router.push({name:"home"}))}),M,q])]),e("main",z,[e("div",E,[e("div",H,[R,d(b,{title:s.title,value:s.selectedPeriod.length>0,onClick:n.openFilter},null,8,["title","value","onClick"])]),e("div",G,[Q,e("p",U,l(s.jumlahPoin),1)]),e("div",W,[(a(!0),r(u,null,g(s.listKonseling,o=>(a(),r("div",{class:"flex flex-row justify-between border-t-2 w-full",key:o,onClick:w=>n.detail(o)},[e("div",Z,[e("p",$,l(o.detail.pelanggaran),1),e("p",ee,l(n.formatDateInd(o.tanggal)),1)]),e("div",te,[e("p",se,l(o.detail.poin),1)])],8,X))),128)),e("div",oe,l(s.message),1)])])])]),d(f,{ref:"myBottomSheet"},{default:x(()=>[e("div",ie,[le,e("div",ne,[(a(!0),r(u,null,g(s.listPeriod,o=>(a(),r("div",{key:o},[d(D,{title:o.label,value:s.selectedPeriod!=null?s.selectedPeriod.includes(o.id):"",onClick:w=>n.setSelectedPeriod(o.id)},null,8,["title","value","onClick"])]))),128))]),e("div",ae,[e("button",{class:"font-mulish text-blue-500",onClick:t[1]||(t[1]=(...o)=>n.batal&&n.batal(...o))},"Batal"),e("button",{class:"ms-12 font-mulish text-blue-500",onClick:t[2]||(t[2]=(...o)=>n.loadData&&n.loadData(...o))},"Terapkan")])])]),_:1},512),d(f,{ref:"detailKonseling"},{default:x(()=>[s.arrDetail!=null?(a(),r("div",re,[e("div",ce,[e("div",de,[he,e("p",_e,l(s.arrDetail.detail.pelanggaran),1)]),e("div",ue,[me,e("p",fe,l(s.arrDetail.detail.poin),1)]),e("div",pe,[ge,e("p",xe,l(n.formatDateInd(s.arrDetail.tanggal)),1)]),e("div",ye,[ve,e("p",ke,l(s.arrDetail.detail.penanganan),1)]),e("div",Pe,[be,e("p",De,l(s.arrDetail.detail.catatan),1)])])])):p("",!0)]),_:1},512)],64)}const Ie=N(T,[["render",we]]);export{Ie as default};
