import{z as d}from"./index-7a3f4d22.js";import{m as n}from"./mainRepositories-174151c3.js";import{m as i}from"./mainLocalStorage-6a318ee8.js";const e={data:[],success:!1,loading:!0,error:null,formData:new FormData},g=d("password",{state:()=>e,actions:{setFormData(t){Object.entries(t).forEach(([a,r])=>{this.formData.append(a,r)})},async sendOtp(t){try{this.setFormData(t);const a=await n.sendOtp(this.formData);return a.data.is_correct?(i.setParamsChangePassword(a.data),this.data=a.data.message,this.success=!0,this.loading=!1):(this.success=!1,this.loading=!1,this.error=a.data.message),JSON.stringify(e)}catch(a){return this.loading=!1,this.error=a.message,JSON.stringify(e)}},async verifyOtp(t){const{kode_sekolah:a,nis:r}=i.getParamsChangePassword(),o={kode_sekolah:a,nis:r,code:t};this.setFormData(o);try{const s=await n.verifyOtp(this.formData);return s.data.is_correct?(i.setParamsChangePassword(s.data),this.data=s.data.message,this.success=!0,this.loading=!1):(this.success=!1,this.loading=!1,this.error=s.data.message),JSON.stringify(e)}catch(s){return this.loading=!1,this.error=s.message,JSON.stringify(e)}},async editPassword(t){const{kode_sekolah:a,nis:r}=i.getParamsChangePassword(),o={kode_sekolah:a,nis:r,reset:t};console.log("resetPassword"),console.log(o),this.setFormData(o);try{const s=await n.resetPassword(this.formData);return console.log("changePassword"),console.log(s),s.data.is_correct?(this.success=!0,this.data=s.data,this.loading=!1):(this.loading=!1,this.error=s.data.message),JSON.stringify(e)}catch(s){return this.loading=!1,this.error=s.message,JSON.stringify(e)}}}});export{g as p};
