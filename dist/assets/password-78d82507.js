import{z as c}from"./index-29abdbc7.js";import{m as d}from"./mainRepositories-2fcd8aa7.js";import{m as i}from"./mainLocalStorage-6a318ee8.js";const e={data:[],success:!1,loading:!0,error:null,formData:new FormData},m=c("password",{state:()=>e,actions:{setFormData(a){Object.entries(a).forEach(([s,o])=>{this.formData.append(s,o)})},async setData(a){this.data=a,console.log("data",a),i.setParamsChangePassword(a)},async sendOtp(a){try{this.setFormData(a);const s=await d.sendOtp(this.formData);return s.data.is_correct?(i.setParamsChangePassword(s.data),this.data=s.data.message,this.success=!0,this.loading=!1):(this.success=!1,this.loading=!1,this.error=s.data.message),JSON.stringify(e)}catch(s){return this.loading=!1,this.error=s.message,JSON.stringify(e)}},async verifyOtp(a){const{kode_sekolah:s,nis:o}=i.getParamsChangePassword(),n={kode_sekolah:s,nis:o,code:a};this.setFormData(n);try{const t=await d.verifyOtp(this.formData);return t.data.is_correct?(i.setParamsChangePassword(t.data),this.data=t.data.message,this.success=!0,this.loading=!1):(this.success=!1,this.loading=!1,this.error=t.data.message),JSON.stringify(e)}catch(t){return this.loading=!1,this.error=t.message,JSON.stringify(e)}},async editPassword(a){},async resetPassword(a,s){console.log("resetPassword",a,s);const{kode_sekolah:o,nis:n}=i.getParamsChangePassword(),t={student_nis:n,kode_sekolah:o,password_lama:a,password_baru:s,konfirmasi_password:s};this.setFormData(t);try{const r=await d.changePassword(this.formData);return console.log("reset Password Response"),console.log(r),r.data.is_correct?(this.success=!0,this.data=r.data,this.loading=!1):(this.loading=!1,this.error=r.data.message),JSON.stringify(e)}catch(r){return this.loading=!1,this.error=r.message,JSON.stringify(e)}}}});export{m as p};
