import{b as S}from"./bayar-7ddd21d6.js";import{M as u}from"./mainLocalStorage-1cdc50c7.js";import{R as A}from"./rupiah-c3f0a7c7.js";import{_ as k}from"./_plugin-vue_export-helper-c27b6911.js";import{r as m,o as r,c,a as e,b as h,t as i,x as p,s as w,F as b,q as v,u as g,A as N}from"./index-c4694308.js";import{q as j}from"./style-7dcc3b35.js";import{a as $,F as I,W as D,G as J}from"./flowbite-vue-9c7e4af1.js";import{L as V}from"./LoadingContainer-c572b9e8.js";import"./mainRepositories-374c5722.js";const O={name:"CaraPembayaranBulananView",props:{result:{type:Object},payment:{type:Object}},data(){return{}},mounted(){console.log(this.result)},methods:{rupiah(o){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(o)},datetimeIdn(o){const s=new Date(o);console.log(s);let t={weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"};return new Intl.DateTimeFormat("id",t).format(s)}}},F={class:"flex flex-col h-100"},T={class:"bg-primaryColors sticky top-0"},z={class:"flex flex-row justify-between"},G=e("p",{class:"text-center text-white font-[500px] font-montserrat py-4"},"Cara Pembayaran",-1),W=e("p",{class:"m-4"},null,-1),H={class:"flex-grow mt-4"},q={class:"container"},E={class:"flex flex-row justify-between w-full"},K={class:"font-mulish text-[20px]"},Z={class:"font-mulish text-sm"},Q=["src"],U={class:"mt-4"},X=e("p",{class:"font-mulish"},"No. Virtual Account",-1),Y={class:"flex flex-row w-full justify-between"},ee={class:"font-mulish"},te=e("p",{class:"font-montserrat text-green-600"},"Salin",-1),se={class:"mt-4"},ae=e("p",{class:"font-mulish"},"Total Pembayaran",-1),ne={class:"font-mulish"},oe={class:"mt-4"},ie=e("p",{class:"font-mulish"},"Biaya Admin",-1),le={class:"font-mulish"},re={class:"mt-4"},ce=e("p",{class:"font-mulish"},"Bayar Sebelum Jatuh Tempo !",-1),de={class:"font-mulish text-red-500"},me={class:"mt-4 mb-2"},ue=e("p",{class:"font-mulish"},"Petunjuk Pembayaran",-1),he={class:"font-mulish"},_e=["innerHTML"],fe={class:"container"};function ye(o,s,t,d,n,a){const _=m("font-awesome-icon");return r(),c("div",F,[e("header",T,[e("div",z,[h(_,{class:"text-white m-4",icon:"arrow-left",onClick:s[0]||(s[0]=f=>o.$router.go(-1))}),G,W])]),e("main",H,[e("div",q,[e("div",E,[e("div",null,[e("p",K,i(t.result.bank??""),1),e("p",Z,i(t.result.bayar_via),1)]),e("img",{src:t.payment.logo,alt:"",class:"w-20"},null,8,Q)]),e("div",U,[X,e("div",Y,[e("p",ee,i(t.result.va),1),te])]),e("div",se,[ae,e("p",ne,i(a.rupiah(parseInt(t.result.total)+parseInt(t.result.fee))),1)]),e("div",oe,[ie,e("p",le,i(a.rupiah(t.result.fee)),1)]),e("div",re,[ce,e("p",de,i(t.result.expired!=null?a.datetimeIdn(t.result.expired):null),1)]),e("div",me,[ue,e("p",he,"Cara Pembayaran "+i(t.result.bayar_via)+" "+i(t.result.bank),1),t.result.carabayar!=null?(r(),c("div",{key:0,class:"container",innerHTML:t.result.carabayar[0].bayar},null,8,_e)):p("",!0)]),e("div",fe,[e("button",{onClick:s[1]||(s[1]=f=>o.$route.push({name:"tabungan"})),class:"rounded-full border-2 text-white my-2 font-montserrat font-medium h-12 w-80 text-center bg-primaryColors"},"Kembali")])])])])}const pe=k(O,[["render",ye]]);const x=S(),be={name:"RingkasanView",components:{VueBottomSheet:j,Accordion:$,AccordionPanel:I,AccordionHeader:D,AccordionContent:J,LoadingCircle:V,CaraPembayaran:pe},data(){return{sendData:null,listMetodeBayar:[],paymentMethod:null,isLoading:null,pembayaranSuccess:null,dataRingkasan:[],listBulan:[],listBebas:[],itemLength:0,totalPay:0}},methods:{setData(){this.sendData=JSON.stringify({student_nis:u.getAuth().nis,kode_sekolah:u.getAuth().kode_sekolah,bayar:"Bayar",bulan_id:[],bebas_id:[]})},async getRingkasan(){this.isLoading=!0,this.setData();let o=await x.listRingkasan(this.sendData),s=JSON.parse(o);if(console.log(s),s.success){this.setMetodeBayar(s.data.bayar),this.dataRingkasan=s.data;const{bebas:t,bulan:d,...n}=s.data;this.dataRingkasan=n,this.listBebas=t,this.listBulan=d,this.itemLength=t.length+d.length,this.totalPay=t.map(a=>parseInt(a.nominal)).reduce((a,_)=>a+_,0)+d.map(a=>parseInt(a.nominal)).reduce((a,_)=>a+_,0),this.isLoading=!1}else this.$snackbar.add({type:"error",text:s.error})},async removeBebas(o){this.isLoading=!0;let s=await x.removeBebas(o),t=JSON.parse(s);console.log("remove bebas"),console.log(t),t.success?this.getRingkasan():this.$snackbar.add({type:"error",text:"Gagal menghapus tagihan"})},async removeBulanan(o){this.isLoading=!0;let s=await x.removeBulanan(o),t=JSON.parse(s);console.log("remove bulan"),console.log(t),t.success?this.getRingkasan():(this.isLoading=!1,this.$snackbar.add({type:"error",text:"Gagal menghapus tagihan"}))},setPayment(o){this.paymentMethod=o,this.close()},async bayar(){this.isLoading=!0;var o=JSON.stringify({student_nis:u.getAuth().nis,kode_sekolah:u.getAuth().kode_sekolah,noref:this.dataRingkasan.noref,nominal:this.totalPay+"",payment_channel:this.paymentMethod.metode,ipaymu_no_trans:u.getNoIpaymu()});const s=await x.insertIpaymuBayar(o),t=JSON.parse(s);if(t.success){var d=JSON.stringify({student_nis:u.getAuth().nis,kode_sekolah:u.getAuth().kode_sekolah,noref:this.dataRingkasan.noref,nominal:this.totalPay+"",payment_channel:this.paymentMethod.metode,ipaymu_no_trans:u.getNoIpaymu()});const n=await x.caraPembayaran(d),a=JSON.parse(n);a.success?(this.isLoading=a.loading,this.pembayaranSuccess=a.data):(this.$snackbar.add({type:"error",text:a.error}),this.isLoading=a.loading,this.paymentMethod=null)}else this.isLoading=t.loading,this.$snackbar.add({type:"error",text:t.error}),this.paymentMethod=null},setMetodeBayar(o){const s=o,t=s.filter(n=>n.metode.startsWith("cstore|")),d=s.filter(n=>n.metode.startsWith("va|"));this.listMetodeBayar=[{nama_bayar:"Virtual Account",items:d},{nama_bayar:"Cstore",items:t}]},open(){this.$refs.metodeBayar.open()},close(){this.$refs.metodeBayar.close()},formatRupiah(o){return A.format(o)}},mounted(){console.log(this.getRingkasan())}},ge={key:1,class:"flex flex-col h-100"},xe={class:"bg-primaryColors top-0 sticky w-full"},we={class:"container flex flex-row items-center justify-between"},ve=e("p",{class:"text-center text-white font-[500px] font-mulish py-4"},"Ringkasan",-1),ke=e("p",null,null,-1),Be={class:"flex-grow pt-4"},Ce={class:"container"},Pe={class:"flex flex-col"},Me=e("p",{class:"font-mulish"},"No. Ref",-1),Re={class:"font-montserrat text-lg"},Le={class:"flex flex-col pt-2"},Se={class:"flex flex-row justify-between pb-4"},Ae={class:"font-mulish uppercase text-sm text-gray-400"},Ne=e("p",{class:"font-mulish uppercase text-sm text-gray-400"},"Jumlah",-1),je={class:"w-full flex flex-col"},$e={class:"font-mulish"},Ie={class:"w-full flex flex-row justify-between"},De={class:"w-full flex items-center"},Je={class:"font-mulish ms-3"},Ve={class:"w-1/3 flex items-center justify-center"},Oe={class:"w-full flex flex-col"},Fe={class:"font-mulish"},Te={class:"w-full flex flex-row justify-between"},ze={class:"w-full flex items-center"},Ge={class:"font-mulish ms-3"},We={class:"w-1/3 flex items-center justify-center"},He={class:"flex flex-row justify-between border-t-2 pt-2 mt-6 mb-6"},qe=e("p",{class:"font-mulish uppercase"},"Total",-1),Ee={class:"font-mulish"},Ke={class:"border-t-2 bottom-0 fixed w-full z-20 bg-gray-50"},Ze={class:"container py-2"},Qe=e("p",{class:"font-mulish text-sm"},"Pilih Metode Pembayaran",-1),Ue={class:"flex flex-row justify-between"},Xe=e("div",{class:"flex flex-col"},[e("p",{class:"font-mulish text-lg font-bold"},"Pilih Bank"),e("p",{class:"font-mulish"},"Jenis Pembayaran")],-1),Ye={class:"flex items-center mt-4"},et={key:1,class:"container py-2"},tt={class:"flex flex-row gap-x-4"},st={class:"flex items-center"},at=["src"],nt={class:"flex flex-col"},ot={class:"font-mulish"},it={class:"font-mulish"},lt={class:"container"},rt=e("p",{class:"text-gray-400 mb-3 font-mulish"},"Pilih Metode Pembayaran",-1),ct={class:"flex flex-row gap-x-2"},dt=["src"],mt={class:"font-mulish"};function ut(o,s,t,d,n,a){const _=m("LoadingCircle"),f=m("font-awesome-icon"),B=m("CaraPembayaran"),C=m("accordion-header"),P=m("accordion-content"),M=m("accordion-panel"),R=m("Accordion"),L=m("vue-bottom-sheet");return r(),c(b,null,[n.isLoading?(r(),w(_,{key:0})):p("",!0),n.pembayaranSuccess==null?(r(),c("div",ge,[e("header",xe,[e("div",we,[h(f,{class:"text-white",icon:"arrow-left",onClick:s[0]||(s[0]=l=>this.$router.push({name:"home"}))}),ve,ke])]),e("main",Be,[e("div",Ce,[e("div",Pe,[Me,e("p",Re,i(n.dataRingkasan.noref),1)]),e("div",Le,[e("div",Se,[e("p",Ae,i(`item (${n.itemLength})`),1),Ne]),(r(!0),c(b,null,v(n.listBulan,l=>(r(),c("div",{key:l,class:"container flex flex-row justify-between border-2 shadow-sm py-2 my-1"},[e("div",je,[e("p",$e,i(l.nama_bayar),1)]),e("div",Ie,[e("div",De,[e("p",Je,i(a.formatRupiah(l.nominal)),1)]),e("div",Ve,[h(f,{icon:["fas","trash"],size:"sm",class:"text-red-500",onClick:y=>a.removeBulanan(l.bulan_id)},null,8,["onClick"])])])]))),128)),(r(!0),c(b,null,v(n.listBebas,l=>(r(),c("div",{key:l,class:"container flex flex-row justify-between border-2 shadow-sm py-2 my-1"},[e("div",Oe,[e("p",Fe,i(l.nama_bayar),1)]),e("div",Te,[e("div",ze,[e("p",Ge,i(a.formatRupiah(l.nominal)),1)]),e("div",We,[h(f,{icon:["fas","trash"],size:"sm",class:"text-red-500",onClick:y=>a.removeBebas(l.bebas_id)},null,8,["onClick"])])])]))),128)),e("div",He,[qe,e("p",Ee,i(a.formatRupiah(n.totalPay)),1)])])])]),e("footer",Ke,[e("div",Ze,[Qe,n.paymentMethod==null?(r(),c("div",{key:0,class:"container py-2",onClick:s[1]||(s[1]=(...l)=>a.open&&a.open(...l))},[e("div",Ue,[Xe,e("div",Ye,[h(f,{icon:["fas","chevron-right"],size:"sm",class:"align-middle ms-2 mb-6"})])])])):p("",!0),n.paymentMethod!=null?(r(),c("div",et,[e("div",tt,[e("div",st,[e("img",{src:n.paymentMethod.logo,alt:"",class:"w-20"},null,8,at)]),e("div",nt,[e("p",ot,i(n.paymentMethod.kode),1),e("p",it,i(n.paymentMethod.bank),1)])])])):p("",!0),e("button",{onClick:s[2]||(s[2]=(...l)=>a.bayar&&a.bayar(...l)),class:"rounded-full bg-primaryColors w-full py-1 my-2 font-mulish text-white"},"Bayar Sekarang")])])])):p("",!0),n.pembayaranSuccess!=null?(r(),w(B,{key:2,result:n.pembayaranSuccess,payment:n.paymentMethod},null,8,["result","payment"])):p("",!0),h(L,{ref:"metodeBayar"},{default:g(()=>[e("div",lt,[rt,(r(!0),c(b,null,v(n.listMetodeBayar,l=>(r(),w(R,{"always-open":"",key:l},{default:g(()=>[h(M,null,{default:g(()=>[h(C,null,{default:g(()=>[N(i(l.nama_bayar),1)]),_:2},1024),(r(!0),c(b,null,v(l.items,y=>(r(),w(P,{key:y,onClick:ht=>a.setPayment(y)},{default:g(()=>[e("div",ct,[e("img",{src:y.logo,alt:"",class:"w-20"},null,8,dt),e("p",mt,i(y.kode),1)])]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024))),128))])]),_:1},512)],64)}const kt=k(be,[["render",ut]]);export{kt as default};
