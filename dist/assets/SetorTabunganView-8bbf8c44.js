import{t as T}from"./tabungan-9762fa8d.js";import{m as _}from"./mainLocalStorage-8f3300f3.js";import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";import{r as c,o as l,c as d,a as t,b as u,t as i,z as f,w as k,v as C,y as b,x as w,F as v,u as M,C as $}from"./index-daccb512.js";import{q as I}from"./style-05dc6766.js";import{a as V,F as j,W as J,G as O}from"./flowbite-vue-29b55b18.js";import{L as D}from"./LoadingContainer-cfea96ab.js";import"./mainRepositories-3199904c.js";const F={name:"CaraPembayaranBulananView",props:{result:{type:Object},payment:{type:Object}},data(){return{}},mounted(){console.log(this.result)},methods:{rupiah(n){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n)},datetimeIdn(n){const e=new Date(n);console.log(e);let a={weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"};return new Intl.DateTimeFormat("id",a).format(e)}}},W={class:"flex flex-col h-100"},H={class:"bg-primaryColors sticky top-0"},K={class:"flex flex-row justify-between"},U=t("p",{class:"text-center text-white font-[500px] font-montserrat py-4"},"Cara Pembayaran",-1),z=t("p",{class:"m-4"},null,-1),G={class:"flex-grow mt-4"},R={class:"container"},q={class:"flex flex-row justify-between w-full"},E={class:"font-mulish text-[20px]"},Z={class:"font-mulish text-sm"},Q=["src"],X={class:"mt-4"},Y=t("p",{class:"font-mulish"},"No. Virtual Account",-1),tt={class:"flex flex-row w-full justify-between"},et={class:"font-mulish"},st=t("p",{class:"font-montserrat text-green-600"},"Salin",-1),at={class:"mt-4"},nt=t("p",{class:"font-mulish"},"Total Pembayaran",-1),ot={class:"font-mulish"},lt={class:"mt-4"},it=t("p",{class:"font-mulish"},"Biaya Admin",-1),rt={class:"font-mulish"},ct={class:"mt-4"},dt=t("p",{class:"font-mulish"},"Bayar Sebelum Jatuh Tempo !",-1),mt={class:"font-mulish text-red-500"},ut={class:"mt-4 mb-2"},ht=t("p",{class:"font-mulish"},"Petunjuk Pembayaran",-1),_t={class:"font-mulish"},ft=["innerHTML"],yt={class:"container"};function pt(n,e,a,h,s,r){const m=c("font-awesome-icon");return l(),d("div",W,[t("header",H,[t("div",K,[u(m,{class:"text-white m-4",icon:"arrow-left",onClick:e[0]||(e[0]=y=>n.$router.go(-1))}),U,z])]),t("main",G,[t("div",R,[t("div",q,[t("div",null,[t("p",E,i(a.result.bank??""),1),t("p",Z,i(a.result.bayar_via),1)]),t("img",{src:a.payment.logo,alt:"",class:"w-20"},null,8,Q)]),t("div",X,[Y,t("div",tt,[t("p",et,i(a.result.va),1),st])]),t("div",at,[nt,t("p",ot,i(r.rupiah(parseInt(a.result.total)+parseInt(a.result.fee))),1)]),t("div",lt,[it,t("p",rt,i(r.rupiah(a.result.fee)),1)]),t("div",ct,[dt,t("p",mt,i(a.result.expired!=null?r.datetimeIdn(a.result.expired):null),1)]),t("div",ut,[ht,t("p",_t,"Cara Pembayaran "+i(a.result.bayar_via)+" "+i(a.result.bank),1),a.result.carabayar!=null?(l(),d("div",{key:0,class:"container",innerHTML:a.result.carabayar[0].bayar},null,8,ft)):f("",!0)]),t("div",yt,[t("button",{onClick:e[1]||(e[1]=y=>n.$route.push({name:"tabungan"})),class:"rounded-full border-2 text-white my-2 font-montserrat font-medium h-12 w-80 text-center bg-primaryColors"},"Kembali")])])])])}const bt=S(F,[["render",pt]]);const x=T(),gt={name:"SetorTabungan",components:{VueBottomSheet:I,Accordion:V,AccordionPanel:j,AccordionHeader:J,AccordionContent:O,CaraPembayaran:bt,LoadingCircle:D},data(){return{paymentMethod:null,listMetodeBayar:null,pembayaranSuccess:null,nominal:null,catatan:null,data:null,isLoading:!1}},methods:{async getMetodeBayar(){const n=await x.listMetodeBayar();console.log(n);var e=JSON.parse(n);this.data=e.data;const a=this.data.metode.filter(s=>s.metode.startsWith("cstore|")),h=this.data.metode.filter(s=>s.metode.startsWith("va|"));this.listMetodeBayar=[{nama_bayar:"Virtual Account",items:h},{nama_bayar:"Cstore",items:a}]},open(){this.$refs.metodeBayar.open()},close(){this.$refs.metodeBayar.close()},setPayment(n){this.paymentMethod=n,this.close()},async bayarTabungan(){if(this.isLoading=!0,this.paymentMethod==null)this.$snackbar.add({type:"error",text:"Pilih Metode Pembayaran"}),this.isLoading=!1;else if(this.nominal==null||parseInt(this.nominal)<1e4)this.$snackbar.add({type:"error",text:"Nominal Masih Kosong atau Kurang dari Rp. 10.000"}),this.isLoading=!1;else{var n=JSON.stringify({nis:_.getAuth().nis,kode_sekolah:_.getAuth().kode_sekolah,nominal:this.nominal,bayar:"Bayar",catatan:this.catatan});const h=await x.topUpTabungan(n);if(JSON.parse(h).success){this.loading=!1;var e=JSON.stringify({student_nis:_.getAuth().nis,kode_sekolah:_.getAuth().kode_sekolah,noref:this.data.nomor,nominal:this.nominal,payment_channel:this.paymentMethod.metode,catatan:this.catatan,ipaymu_no_trans:this.data.no_ipaymu});const r=await x.insertIpaymu(e),m=JSON.parse(r);if(console.log(m),m.success){var a=JSON.stringify({student_nis:_.getAuth().nis,kode_sekolah:_.getAuth().kode_sekolah,noref:this.data.nomor,nominal:this.nominal,payment_channel:this.paymentMethod.metode,ipaymu_no_trans:this.data.no_ipaymu});const y=await x.caraPembayaran(a),p=JSON.parse(y);p.success?(this.isLoading=p.loading,this.pembayaranSuccess=p.data):(this.isLoading=!1,this.paymentMethod=null,this.$snackbar.add({type:"error",text:"Bank Pembayaran Sedang Bermasalah"}))}else console.log("error"),this.$snackbar.add({type:"error",text:m.erorr}),this.$router.push({name:"tabungan"})}else this.$snackbar.add({type:"error",text:h.erorr}),this.loading=!1}}},mounted(){this.getMetodeBayar()}},xt={key:0,class:"flex flex-col h-100"},wt={class:"sticky top-0 w-full bg-primaryColors"},vt={class:"container flex flex-row items-center justify-between"},kt=t("p",{class:"text-center text-white font-[500px] font-mulish py-4"},"Setor Tabungan",-1),Ct=t("p",null,null,-1),Mt={class:"flex-grow pt-4"},St={class:"container flex flex-col gap-y-3"},Bt={class:"fixed bottom-0 w-full border-t-2"},Pt={class:"container py-2"},At=t("p",{class:"text-sm font-mulish"},"Pilih Metode Pembayaran",-1),Nt={class:"flex flex-row justify-between"},Lt=t("div",{class:"flex flex-col"},[t("p",{class:"text-lg font-bold font-mulish"},"Pilih Bank"),t("p",{class:"font-mulish"},"Jenis Pembayaran")],-1),Tt={class:"flex items-center mt-4"},$t={key:1,class:"container py-2"},It={class:"flex flex-row gap-x-4"},Vt={class:"flex items-center"},jt=["src"],Jt={class:"flex flex-col"},Ot={class:"font-mulish"},Dt={class:"font-mulish"},Ft={class:"container"},Wt=t("p",{class:"mb-3 text-gray-400 font-mulish"},"Pilih Metode Pembayaran",-1),Ht={class:"flex flex-row gap-x-2"},Kt=["src"],Ut={class:"font-mulish"},zt={key:1,class:"flex flex-col items-center justify-center h-full"};function Gt(n,e,a,h,s,r){const m=c("font-awesome-icon"),y=c("accordion-header"),p=c("accordion-content"),B=c("accordion-panel"),P=c("Accordion"),A=c("vue-bottom-sheet"),N=c("LoadingCircle"),L=c("CaraPembayaran");return l(),d(v,null,[s.pembayaranSuccess==null?(l(),d("div",xt,[t("header",wt,[t("div",vt,[u(m,{class:"text-white",icon:"arrow-left",onClick:e[0]||(e[0]=o=>this.$router.push({name:"home"}))}),kt,Ct])]),t("main",Mt,[t("div",St,[k(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.nominal=o),type:"text",class:"w-full px-2 py-4 border-2 border-gray-400 rounded-lg font-mulish",placeholder:"Masukkan Nominal"},null,512),[[C,s.nominal]]),k(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.catatan=o),type:"text",class:"w-full px-2 py-4 border-2 border-gray-400 rounded-lg font-mulish",placeholder:"Catatan"},null,512),[[C,s.catatan]])])]),t("footer",Bt,[t("div",Pt,[At,s.paymentMethod==null?(l(),d("div",{key:0,class:"container py-2",onClick:e[3]||(e[3]=(...o)=>r.open&&r.open(...o))},[t("div",Nt,[Lt,t("div",Tt,[u(m,{icon:["fas","chevron-right"],size:"sm",class:"mb-6 align-middle ms-2"})])])])):f("",!0),s.paymentMethod!=null?(l(),d("div",$t,[t("div",It,[t("div",Vt,[t("img",{src:s.paymentMethod.logo,alt:"",class:"w-20"},null,8,jt)]),t("div",Jt,[t("p",Ot,i(s.paymentMethod.kode),1),t("p",Dt,i(s.paymentMethod.bank),1)])])])):f("",!0),t("button",{onClick:e[4]||(e[4]=(...o)=>r.bayarTabungan&&r.bayarTabungan(...o)),class:"w-full py-1 my-2 text-white rounded-full bg-primaryColors font-mulish"},"Bayar Sekarang")])])])):f("",!0),u(A,{ref:"metodeBayar"},{default:b(()=>[t("div",Ft,[Wt,(l(!0),d(v,null,M(s.listMetodeBayar,o=>(l(),w(P,{"always-open":"",key:o},{default:b(()=>[u(B,null,{default:b(()=>[u(y,null,{default:b(()=>[$(i(o.nama_bayar),1)]),_:2},1024),(l(!0),d(v,null,M(o.items,g=>(l(),w(p,{key:g,onClick:Rt=>r.setPayment(g)},{default:b(()=>[t("div",Ht,[t("img",{src:g.logo,alt:"",class:"w-20"},null,8,Kt),t("p",Ut,i(g.kode),1)])]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024))),128))])]),_:1},512),s.isLoading?(l(),d("div",zt,[u(N)])):f("",!0),s.pembayaranSuccess!=null?(l(),w(L,{key:2,result:s.pembayaranSuccess,payment:s.paymentMethod},null,8,["result","payment"])):f("",!0)],64)}const se=S(gt,[["render",Gt]]);export{se as default};
