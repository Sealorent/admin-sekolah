import{z as w,r as a,o as i,c as r,s as C,x as B,a as t,b as c,F as h,q as m,t as f,u as S,y as F}from"./index-c4694308.js";import{m as L}from"./mainRepositories-374c5722.js";import{A as b}from"./arrayPeriod-595fbeb3.js";import{F as D}from"./dateFormat-14868802.js";import{M as y}from"./mainLocalStorage-1cdc50c7.js";import{a as A,B as N}from"./ButtonFilterYear-829235c6.js";import{q as j}from"./style-7dcc3b35.js";import{L as J}from"./LoadingContainer-c572b9e8.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";import"./flowbite-vue-9c7e4af1.js";const u={data:[],loading:!0,error:null},I=w("presensi",{state:()=>u,actions:{async listPresensi(s){try{let e=await L.listPresensi(s);return console.log(e),e.data.is_correct==!0?(this.data=e.data.laporan,this.loading=!1,this.error=null):(this.loading=!1,this.error=e.data.laporan),console.log(u),JSON.stringify(u)}catch(e){return this.loading=!1,this.error=e.message,JSON.stringify(u)}}}});class O{static getListMonth(){return[{month:"Januari",number:7},{month:"Februari",number:8},{month:"Maret",number:9},{month:"April",number:10},{month:"Mei",number:11},{month:"Juni",number:12},{month:"Juli",number:1},{month:"Agustus",number:2},{month:"September",number:3},{month:"Oktober",number:4},{month:"November",number:5},{month:"Desember",number:6}]}static getFirstMonth(){let e=this.getListMonth();var d=new Date;return e.filter(_=>_.number==d.getMonth()+1-6)[0]}static getArrayMonth(){return this.getListMonth().map(d=>d.number)}}const v=O;const T=I(),Y={name:"PresensiView",components:{ButtonFilterYear:A,VueBottomSheet:j,ButtonFilter:N,LoadingCircle:J},data(){return{listPresensi:[],listMonth:v.getListMonth(),listPeriod:b.getList(),selectedPeriod:[],selectedMonth:[],title:"Pilih Tahun",message:null,isLoading:!1}},methods:{setData(){this.sendData=JSON.stringify({nis:y.getAuth().nis,kode_sekolah:y.getAuth().kode_sekolah,period_id:this.selectedPeriod==null||this.selectedPeriod<1?b.getArray():this.selectedPeriod.map(s=>parseInt(s)),bulan:this.selectedMonth==null||this.selectedMonth<1?v.getArrayMonth():this.selectedMonth.map(s=>parseInt(s))})},async getPresensi(){this.isLoading=!0,this.setData();let s=await T.listPresensi(this.sendData);var e=JSON.parse(s);e.error==null?(this.listPresensi=e.data,this.isLoading=e.loading,this.message=e.error):(this.listPresensi=[],this.message=e.message,this.isLoading=e.loading,this.message=e.error),console.log(e)},setSelectedPeriod(s){this.selectedPeriod.includes(s)?this.selectedPeriod=this.selectedPeriod.filter(e=>e!=s):this.selectedPeriod.push(s)},setSelectedMonth(s){this.selectedMonth.includes(s)?this.selectedMonth=this.selectedMonth.filter(e=>e!=s):this.selectedMonth.push(s)},loadData(){this.getPresensi(),this.closeFilter()},openFilter(){this.$refs.myBottomSheet.open()},closeFilter(){this.$refs.myBottomSheet.close()},formatDateInd(s){return D.fullYearInd(s)}},mounted(){this.getPresensi()}},H={class:"flex flex-col h-100"},q={class:"bg-primaryColors top-0 sticky w-full"},z={class:"container flex flex-row items-center justify-between"},E=t("p",{class:"text-center text-white font-[20px] font-mulish py-4"},"Presensi",-1),R=t("p",null,null,-1),G={class:"flex-grow pt-4"},K={class:"container flex flex-col gap-y-5"},Q={class:"flex flex-row justify-between items-center"},U=t("p",{class:"font-mulish"},"Tahun Ajaran",-1),W={class:"flex flex-col"},X=["onClick"],Z={class:"font-mulish"},$={class:"flex items-center justify-center"},ee={class:"flex flex-col pb-10"},te={class:"container"},se=t("p",{class:"text-gray-400 mb-3 font-mulish"},"Pilih Tahun Ajaran",-1),oe={class:"grid grid-cols-3 gap-3 pt-1"},ne={class:"container mt-2"},ie=t("p",{class:"text-gray-400 my-3 font-mulish"},"Pilih Bulan",-1),re={class:"grid grid-cols-4 gap-3 pt-1"},le={class:"flex flex-row justify-end text-end pt-10"};function ae(s,e,d,_,n,l){const P=a("LoadingCircle"),x=a("font-awesome-icon"),M=a("ButtonFilterYear"),p=a("ButtonFilter"),k=a("vue-bottom-sheet");return i(),r(h,null,[n.isLoading?(i(),C(P,{key:0})):B("",!0),t("div",H,[t("header",q,[t("div",z,[c(x,{class:"text-white",icon:"arrow-left",onClick:e[0]||(e[0]=o=>this.$router.push({name:"home"}))}),E,R])]),t("main",G,[t("div",K,[t("div",Q,[U,c(M,{title:n.title,value:n.selectedPeriod.length>0||n.selectedMonth.length>0,onClick:l.openFilter},null,8,["title","value","onClick"])]),t("div",W,[(i(!0),r(h,null,m(n.listPresensi,o=>(i(),r("div",{class:"flex flex-row justify-between border-t-2 w-full py-4",key:o,onClick:g=>s.detail(o)},[t("p",Z,f(l.formatDateInd(o.detail.tanggal)),1),t("p",{class:F(["font-mulish",o.detail.kehadiran=="H"?"text-green-500":"text-red-500"])},f(o.detail.kehadiran=="H"?"Hadir":"Absen"),3)],8,X))),128)),t("div",$,f(n.message),1)])])])]),c(k,{ref:"myBottomSheet"},{default:S(()=>[t("div",ee,[t("div",te,[se,t("div",oe,[(i(!0),r(h,null,m(n.listPeriod,o=>(i(),r("div",{key:o},[c(p,{title:o.label,value:n.selectedPeriod!=null?n.selectedPeriod.includes(o.id):"",onClick:g=>l.setSelectedPeriod(o.id)},null,8,["title","value","onClick"])]))),128))])]),t("div",ne,[ie,t("div",re,[(i(!0),r(h,null,m(n.listMonth,o=>(i(),r("div",{key:o},[c(p,{title:o.month,value:n.selectedMonth!=null?n.selectedMonth.includes(o.number):"",onClick:g=>l.setSelectedMonth(o.number)},null,8,["title","value","onClick"])]))),128))]),t("div",le,[t("button",{class:"font-mulish text-blue-500",onClick:e[1]||(e[1]=(...o)=>s.batal&&s.batal(...o))},"Batal"),t("button",{class:"ms-12 font-mulish text-blue-500",onClick:e[2]||(e[2]=(...o)=>l.loadData&&l.loadData(...o))},"Terapkan")])])])]),_:1},512)],64)}const ye=V(Y,[["render",ae]]);export{ye as default};
